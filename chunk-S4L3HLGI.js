import{e as a,g as i,ha as n,i as u,l as h,o as l,u as o,ua as c}from"./chunk-BK56FB5U.js";var g={baseUrl:"http://localhost:3000/api"};var m=g.baseUrl,p=class r{_authStatus=o("checking");_user=o(null);_token=o(localStorage.getItem("token"));http=l(c);authStatus=n(()=>this._authStatus()==="checking"?"checking":this._user()&&this._token()?"authenticated":"not-authenticated");user=n(()=>this._user());token=n(()=>this._token());isAdmin=n(()=>this._user()?.roles.includes("admin")??!1);login(t,e){return this.http.post(`${m}/auth/login`,{email:t,password:e}).pipe(i(s=>this.handerLoginSuccess(s)),u(s=>this.handleLoginError(s)))}checkAuthStatus(){return localStorage.getItem("token")?this.http.get(`${m}/auth/check-status`,{}).pipe(i(e=>this.handerLoginSuccess(e)),u(e=>this.handleLoginError(e))):(this.logout(),a(!1))}logout(){this._authStatus.set("not-authenticated"),this._user.set(null),this._token.set(null),localStorage.removeItem("token")}handerLoginSuccess(t){return this._authStatus.set("authenticated"),this._user.set(t.user),this._token.set(t.token),localStorage.setItem("token",t.token),!0}handleLoginError(t){return this.logout(),a(!1)}static \u0275fac=function(e){return new(e||r)};static \u0275prov=h({token:r,factory:r.\u0275fac,providedIn:"root"})};export{p as a};
